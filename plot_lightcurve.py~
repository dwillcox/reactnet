import numpy as np
import matplotlib.pyplot as plt

# Time in units of d
t = np.linspace(0.0, 200.0, 1000, endpoint=True)
s_per_day = 8.64e4

# Lightcurve for 1Msun Ni-56 in ergs/s
lambda_ni = 1.321e-6  # /s
lambda_co = 0.1039e-6 # /s
lambda_ni = lambda_ni * s_per_day
lambda_co = lambda_co * s_per_day
q_ni = 2.136 # MeV
q_co = 4.566 # MeV
erg_per_MeV = 1.602e-6
q_ni = q_ni * erg_per_MeV
q_co = q_co * erg_per_MeV
L = (lambda_ni/(lambda_ni-lambda_co)) * (
    (lambda_ni * (q_ni - q_co) - lambda_co*q_ni) * np.exp(-lambda_ni * t) +
    (lambda_co * q_co * np.exp(-lambda_co * t)
    ))
y_ni = np.exp(-lambda_ni * t)
y_co = (lambda_ni/(lambda_ni - lambda_co)) * (np.exp(-lambda_co * t) - np.exp(-lambda_ni * t))

m_ni  = 1.9885e33 # mass of sun in g
m_amu = 1.661e-24 # mass of 1 amu in g

L = L*m_ni/m_amu


#Ltemp = q_ni * lambda_ni * y_ni + q_co * lambda_co * y_co

# Plot
fig = plt.figure()
ax = fig.add_subplot(211)
#plt.xticks([])
#plt.yticks([])
ax.set_ylim([0, max(L)])
ax.plot(t, L, color='black')
#fig.set_size_inches(5,3)

#plt.xlabel('$E/E_F$')
plt.ylabel('$L(t) ~ \\mathrm{(erg/day)}$')
#ax.text(1.025, -0.05, '$E/E_F$', transform=ax.transAxes)
#ax.text(-0.01, 1.05, '$F$', transform=ax.transAxes)
#plt.legend(handles=[na23_h, ne23_h], loc='center right')
#plt.title(which_den+' density URCA', y = 1.01)

ax = fig.add_subplot(212)
ni_h, = ax.plot(t, y_ni, color='blue', label='Ni-56')
co_h, = ax.plot(t, y_co, color='red', label='Co-56')
plt.legend(handles=[ni_h, co_h], loc='upper right')
plt.xlabel('$t ~ \\mathrm{(days)}$')
plt.ylabel('$Y(t)$')
#plt.tight_layout(pad=3, w_pad = 3, h_pad=1.0)
#plt.savefig('fermi_degeneracy.png', dpi=300)
plt.savefig('lightcurve_1Msun-ni56.pdf')    
